# =============================================================================
# SSH Configuration Template
# =============================================================================
#
# Copy this file to ~/.ssh/config and customize for your environment.
# This provides secure defaults and examples for common scenarios.
#
# Usage:
#   cp ~/.dotfiles/.ssh/config.example ~/.ssh/config
#   chmod 600 ~/.ssh/config
#
# =============================================================================

# =============================================================================
# GLOBAL DEFAULTS
# =============================================================================
#
# These settings apply to all hosts unless overridden.
# They provide secure defaults and quality-of-life improvements.
#
# =============================================================================

Host *
    # -------------------------------------------------------------------------
    # Security Settings
    # -------------------------------------------------------------------------
    # Only use strong, modern key exchange and ciphers
    KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
    Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
    MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com

    # Prefer Ed25519 keys (most secure), fall back to RSA
    IdentityFile ~/.ssh/id_ed25519
    IdentityFile ~/.ssh/id_rsa

    # Only use keys explicitly configured for this host
    IdentitiesOnly yes

    # -------------------------------------------------------------------------
    # Connection Settings
    # -------------------------------------------------------------------------
    # Keep connections alive (useful for flaky networks)
    ServerAliveInterval 60
    ServerAliveCountMax 3

    # Reuse connections for faster subsequent connections
    ControlMaster auto
    ControlPath ~/.ssh/sockets/%r@%h-%p
    ControlPersist 600

    # Faster initial connections
    AddKeysToAgent yes

    # macOS: Use Keychain for passphrase storage
    UseKeychain yes

    # Compression for slow connections
    Compression yes

# =============================================================================
# GITHUB
# =============================================================================
#
# GitHub SSH configuration. Uses Ed25519 key by default.
# Generate key: ssh-keygen -t ed25519 -C "your_email@example.com"
#
# =============================================================================

Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_ed25519_github
    IdentitiesOnly yes

# GitHub Enterprise (if you use it)
# Host github.mycompany.com
#     HostName github.mycompany.com
#     User git
#     IdentityFile ~/.ssh/id_ed25519_work

# =============================================================================
# AWS EC2 INSTANCES
# =============================================================================
#
# Configure access to AWS EC2 instances.
# Consider using SSM Session Manager instead of direct SSH for better security.
#
# =============================================================================

# Bastion / Jump Host
# Host bastion
#     HostName bastion.example.com
#     User ec2-user
#     IdentityFile ~/.ssh/aws-bastion.pem
#     ForwardAgent yes

# Connect to private instances through bastion
# Host 10.0.*.*
#     User ec2-user
#     IdentityFile ~/.ssh/aws-private.pem
#     ProxyJump bastion

# EC2 instances by environment
# Host aws-dev-*
#     User ec2-user
#     IdentityFile ~/.ssh/aws-dev.pem
#     ProxyJump bastion

# Host aws-prod-*
#     User ec2-user
#     IdentityFile ~/.ssh/aws-prod.pem
#     ProxyJump bastion
#     # Extra confirmation for production
#     RequestTTY yes

# =============================================================================
# KUBERNETES NODES
# =============================================================================
#
# Direct access to Kubernetes nodes (use kubectl exec when possible).
#
# =============================================================================

# Host k8s-node-*
#     User ubuntu
#     IdentityFile ~/.ssh/k8s-nodes.pem
#     ProxyJump bastion

# =============================================================================
# DEVELOPMENT SERVERS
# =============================================================================

# Local development VM
# Host dev-vm
#     HostName 192.168.1.100
#     User developer
#     IdentityFile ~/.ssh/id_ed25519
#     LocalForward 3000 localhost:3000
#     LocalForward 5432 localhost:5432

# Remote development server
# Host dev-remote
#     HostName dev.example.com
#     User myuser
#     IdentityFile ~/.ssh/id_ed25519_dev
#     ForwardAgent yes
#     # Forward VS Code Remote SSH port
#     LocalForward 9999 localhost:9999

# =============================================================================
# RASPBERRY PI / HOME LAB
# =============================================================================

# Host pi
#     HostName raspberrypi.local
#     User pi
#     IdentityFile ~/.ssh/id_ed25519

# Host homelab
#     HostName 192.168.1.50
#     User admin
#     IdentityFile ~/.ssh/id_ed25519_homelab

# =============================================================================
# NOTES
# =============================================================================
#
# 1. Create the sockets directory:
#    mkdir -p ~/.ssh/sockets
#
# 2. Generate an Ed25519 key (recommended):
#    ssh-keygen -t ed25519 -C "your_email@example.com" -f ~/.ssh/id_ed25519
#
# 3. Copy public key to server:
#    ssh-copy-id -i ~/.ssh/id_ed25519.pub user@server
#
# 4. Test configuration:
#    ssh -T git@github.com
#
# 5. Debug connection issues:
#    ssh -vvv hostname
#
# =============================================================================
