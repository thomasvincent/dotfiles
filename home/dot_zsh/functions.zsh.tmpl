# Shell functions
# Managed by chezmoi - DO NOT EDIT DIRECTLY

# Platform detection â€” set once, used by all modules
(( IS_MACOS = VENDOR == "apple" ))

# Create a directory and cd into it
mkd() { mkdir -p "$@" && cd "$_" || return; }
# Backward compatibility wrapper
mkcd() { mkd "$@"; }

# Determine size of a file or total size of a directory
fs() {
  if du -b /dev/null > /dev/null 2>&1; then
    local arg=-sbh
  else
    local arg=-sh
  fi
  if [[ $# -gt 0 ]]; then
    du $arg -- "$@"
  else
    du $arg .[^.]* ./*
  fi
}

# UTF-8-encode a string of Unicode hex characters
unidecode() { perl -e "binmode(STDOUT, ':utf8'); print chr(0x$_) for @ARGV" "$@"; echo; }

# Show all the names for a color
showcolors() {
  for i in {0..255}; do
    printf "\x1b[38;5;${i}mcolour%-5i\x1b[0m" $i
    if (( i % 8 == 7 )); then echo; fi
  done
}

# Highlight a pattern in command output
hl() { grep --color=always -E "$1|$" "${@:2}"; }

# URL-encode a string (used by GTD workflow modules)
_url_encode() {
  printf '%s' "$1" | python3 -c "import urllib.parse, sys; print(urllib.parse.quote(sys.stdin.read()))"
}

# Bail out if a command is missing
_require_cmd() {
  command -v "$1" >/dev/null 2>&1 && return 0
  echo "Error: $1 is not installed.${2:+ Install with: $2}"
  return 1
}

# Cross-platform URL/file opener
_open_url() {
  if (( IS_MACOS )); then
    open "$@"
  elif (( $+commands[xdg-open] )); then
    xdg-open "$@"
  else
    print "No opener found (install xdg-utils)" >&2
    return 1
  fi
}
