# .zshrc
# Managed by chezmoi - DO NOT EDIT DIRECTLY

# Enable Powerlevel10k instant prompt
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# Set default editor
export EDITOR='{{ .preferences.editor | default "vim" }}'

# Load plugins and modules
source "$HOME/.zsh/aliases.zsh"
source "$HOME/.zsh/functions.zsh"
source "$HOME/.zsh/completion.zsh"
source "$HOME/.zsh/history.zsh"
source "$HOME/.zsh/keybindings.zsh"

# Load conditionally enabled modules
{{- if .enable_cloud }}
source "$HOME/.zsh/cloud.zsh"
{{- end }}

{{- if .security.gpg_signing | or .security.use_ssh_agent | or .security.use_keychain | or .security.use_1password | or .security.use_yubikey }}
source "$HOME/.zsh/security.zsh"
{{- end }}

# Workflow modules
{{- if .enable_workflows }}
source "$HOME/.zsh/workflows.zsh"
{{- end }}

{{- if .enable_productivity }}
source "$HOME/.zsh/productivity.zsh"
{{- end }}

# CI/CD workflows
{{- if or .enable_workflows .enable_dev_tools }}
source "$HOME/.zsh/cicd.zsh"
{{- end }}

# Development workflows
{{- if .enable_dev_tools }}
source "$HOME/.zsh/dev_workflows.zsh"
{{- end }}

# App integrations
{{- if .enable_productivity }}
source "$HOME/.zsh/app_workflows.zsh"
{{- end }}

# Ansible workflows
{{- if or .preferences.enable_ansible .enable_dev_tools }}
source "$HOME/.zsh/ansible_workflows.zsh"
{{- end }}

# Java/Gradle workflows
{{- if or .preferences.enable_java .enable_dev_tools }}
source "$HOME/.zsh/java_gradle_workflows.zsh"
{{- end }}

# Groovy workflows
{{- if or .preferences.enable_groovy .enable_dev_tools }}
source "$HOME/.zsh/groovy_workflows.zsh"
{{- end }}

# AI/LLM workflows
{{- if .preferences.enable_ai }}
[[ -f "$HOME/.zsh/ai_workflows.zsh" ]] && source "$HOME/.zsh/ai_workflows.zsh"
{{- end }}

# Rails workflows
{{- if or .preferences.enable_rails .enable_dev_tools }}
source "$HOME/.zsh/rails_workflows.zsh"
{{- end }}

# OmniFocus workflows
{{- if or .preferences.enable_omnifocus .enable_productivity }}
source "$HOME/.zsh/omnifocus_workflows.zsh"
{{- end }}

# Rust workflows
{{- if or .preferences.enable_rust .enable_dev_tools }}
source "$HOME/.zsh/rust_workflows.zsh"
{{- end }}

# Ruby workflows
{{- if or .preferences.enable_ruby .enable_dev_tools }}
source "$HOME/.zsh/ruby_workflows.zsh"
{{- end }}

# HashiCorp workflows
{{- if or .preferences.enable_hashicorp .enable_dev_tools }}
source "$HOME/.zsh/hashicorp_workflows.zsh"
{{- end }}

# VS Code workflows
{{- if or .preferences.enable_vscode .enable_editors }}
source "$HOME/.zsh/vscode_workflows.zsh"
{{- end }}

# GitHub workflows
{{- if or .preferences.enable_github .enable_dev_tools }}
source "$HOME/.zsh/github_workflows.zsh"
{{- end }}

# GTD workflows with different platforms
{{- if or .enable_macos_gtd .enable_gtd }}
source "$HOME/.zsh/macos_gtd_workflows.zsh"
{{- end }}

{{- if or .enable_google_gtd .enable_gtd }}
source "$HOME/.zsh/google_gtd_workflows.zsh"
{{- end }}

{{- if or .enable_microsoft_gtd .enable_gtd }}
source "$HOME/.zsh/microsoft_gtd_workflows.zsh"
{{- end }}

# FZF integration
source "$HOME/.zsh/fzf.zsh"

# Modern tool replacements
source "$HOME/.zsh/modern_tools.zsh"

# Utility functions
source "$HOME/.zsh/utils.zsh"

# Local customizations
[[ -f "$HOME/.zshrc.local" ]] && source "$HOME/.zshrc.local"

# Load powerlevel10k configuration
[[ -f "$HOME/.p10k.zsh" ]] && source "$HOME/.p10k.zsh"
